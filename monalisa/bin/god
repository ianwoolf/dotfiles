#!/usr/bin/expect
set timeout -1

proc do_first_login {} {
        interact -nobuffer -re "\r" {
            return 
        }
        expect "$"
        send "ssh  yujinqiu@tc-iknow-cc00.tc\r"
        expect "$"
        send "sudo -iu root\r"
        expect "#"
        send "su - arch\r"
        send "clear\r"
        interact
}

proc do_duplicate_login {} {
        send "ssh  yujinqiu@tc-iknow-cc00.tc\r"
        send "sudo -iu root\r"
        expect "#"
        send "su - arch\r"
        send "clear\r"
        interact
}

spawn /usr/bin/ssh yujinqiu@relay01.baidu.com
expect {
    "PASSCODE:$" { 
        do_first_login
    }
    "Password" {
        do_first_login
    }
    "Last login" {
        do_duplicate_login
    }
}
